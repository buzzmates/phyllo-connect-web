
<html lang="en">
  <head>
    <title>Phyllo Sample App</title>
    <link rel="icon" href="/static/favicon_64x64.svg" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" href="/static/style.css" />
    <script
      defer
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
    ></script>
    <!-- Phyllo Connect SDK CDN -->
    <script
      defer
      src="https://cdn.getphyllo.com/connect/v2/phyllo-connect.js"
    ></script>
    <script
      defer
      type="text/javascript"
      src="./dist/phylloAPIHelper.js"
    ></script>
  </head>

  <body>
    <script defer type="text/javascript">
      const phylloSDKConnect = async (workPlatformId = null) => {
        try {
          const env = "staging"; // the mode in which you want to use the SDK,  `sandbox` or `production`
          // const uniqId = new Date().getTime(); // Unique ID for the user supplied by you.
          // const isExistingUser =
          //   document.getElementById("isExistingUser").checked;
          // const userId = await createUser(
          //   "phyllo-user",
          //   uniqId,
          //   isExistingUser
          // );
          // console.log('userId: ', userId)
          // const token = await createSDKToken(userId);
          const appName = "Buzzmates";

          const config = {
            environment: env,
            userId: 'c97f0d46-a642-47fd-b400-880908492dda',
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiYzk3ZjBkNDYtYTY0Mi00N2ZkLWI0MDAtODgwOTA4NDkyZGRhIiwidGVuYW50X2lkIjoiZGI0MzExOGMtNzNhNy00Y2Q5LWFmN2ItMGU4NGY2ZGMxZjJlIiwidGVuYW50X2FwcF9pZCI6IjI1MWFiNjQ5LTM0NjUtNGJjOS05ZjQ0LWQ2MDg1ZmQxNTE2NiIsInByb2R1Y3RzIjpbIkVOR0FHRU1FTlRfQVVESUVOQ0UiLCJBQ1RJVklUWSIsIklERU5USVRZX0FVRElFTkNFIiwiSURFTlRJVFkiLCJFTkdBR0VNRU5UIiwiSU5DT01FIl0sImlzcyI6Imh0dHBzOi8vYXBpLmdldHBoeWxsby5jb20iLCJhdWQiOiJodHRwczovL2FwaS5nZXRwaHlsbG8uY29tL3YxL2ludGVybmFsIiwiaWF0IjoxNzEyNzYwNjczLjQ1MDEyMSwiZXhwIjoxNzEzMzY1NDczLjQ1MDExNH0.UMIkBv6NqEdpwzSysmQ361HvexHhAntEvWgObzzNS7U',
            clientDisplayName: appName,
            workPlatformId:workPlatformId
          };
          const phylloConnect = window.PhylloConnect.initialize(config);

          // callbacks
          phylloConnect.on(
            "accountConnected",
            (accountId, workplatformId, userId) => {
              // gives the successfully connected account ID and work platform ID for the given user ID
              console.log(
                `onAccountConnected: ${accountId}, ${workplatformId}, ${userId}`
              );
            }
          );
          phylloConnect.on(
            "accountDisconnected",
            (accountId, workplatformId, userId) => {
              // gives the successfully disconnected account ID and work platform ID for the given user ID
              console.log(
                `onAccountDisconnected: ${accountId}, ${workplatformId}, ${userId}`
              );
            }
          );
          phylloConnect.on("tokenExpired", (userId) => {
            // gives the user ID for which the token has expired
            console.log(`onTokenExpired: ${userId}`); // the SDK closes automatically in case the token has expired, and you need to handle this by showing an appropriate UI and messaging to the users
          });
          phylloConnect.on("exit", (reason, userId) => {
            // indicates that the user with given user ID has closed the SDK and gives an appropriate reason for it
            console.log(`onExit: ${reason}, ${userId}`);
          });
          phylloConnect.on(
            "connectionFailure",
            (reason, workplatformId, userId) => {
              // optional, indicates that the user with given user ID has attempted connecting to the work platform but resulted in a failure and gives an appropriate reason for it
              console.log(
                `onConnectionFailure: ${reason}, ${workplatformId}, ${userId}`
              );
            }
          );

          phylloConnect.open();
        } catch (err) {
          console.log(err);
        }
      };
    </script>
    <div class="screen_box">
      <div class="top_navbar">
        <h2>Phyllo Sample App</h2>
      </div>
      <div class="content_text_box">
        <div class="content_data">
          <div class="btn_group">
            <button onclick="phylloSDKConnect()">
              Connect Platform Account(s)
            </button>
            <button
              onclick="phylloSDKConnect('9bb8913b-ddd9-430b-a66a-d74d846e6c66')"
            >
              Connect Instagram using Phyllo
            </button>
            <button
              onclick="phylloSDKConnect('14d9ddf5-51c6-415e-bde6-f8ed36ad7054')"
            >
              Connect YouTube using Phyllo
            </button>
            <div class="check_box">
              <input type="checkbox" id="isExistingUser" />
              <label for="isExistingUser">Existing User</label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
